import{j as o,k as Q,n as X}from"./design-system-R5PU-KJ5.js";import{h as Z,u as $,r as h,d as V}from"./react-vendor-DvN4Y5o0.js";import{H as E}from"./style-vendor-CCa_bSPe.js";import{m as U,j as tt,o as et,l as ot}from"./index-D4m5LYf9.js";import{A as st,S as at,C as it,a as nt}from"./AddSeatType-DUSRbZG1.js";import{W as rt}from"./WithNavigatorBar-BaUD9vuh.js";import{u as ct,b as mt,p as lt}from"./index-BhlJXPXA.js";import{u as pt}from"./useStudyRoom-BGqrPZyW.js";import{u as ut}from"./useForm-DVm8TY_W.js";import{u as dt}from"./useObj-Bg0VYG3V.js";import"./queryKeys-B7CxYHCA.js";import"./utils-vendor-Bc17E_qf.js";import"./excel-vendor-CYB7cqj3.js";import"./decoder-D13FVXDo.js";import"./query-vendor-CBGQWAC0.js";import"./useDropDown-hVZVKMV4.js";import"./index-BYUM15lW.js";import"./useSchoolsApi-kltzsy-n.js";const Ot=()=>{const{id:S}=Z(),{state:w,setState:b}=ut([]),A=$().state.timeSlotId,{data:p}=U(S,A),[I,_]=h.useState(!1),[P,M]=h.useState(""),{selectModal:L,modalState:f}=ct(),{studyRoomState:s,onChangeGrade:v,onChangeInput:g,onChangeSex:B,onChangeSeatSetting:O,onChangeStudyTime:k,initalValue:N}=pt(),W=()=>p.time_slots.map(t=>t.id);h.useEffect(()=>{N(p)},[p]);const{name:u,floor:i,total_height_size:y,total_width_size:x,east_description:r,west_description:c,south_description:m,north_description:l,...C}=s,{seat:ft,...D}=s,{data:d,refetch:Y}=tt(),{mutateAsync:z}=et(S,{...D,time_slot_ids:w,seats:D.seats.map(t=>{var n;return{width_location:t.width_location,height_location:t.height_location,number:t.number||null,status:t.status==="IN_USE"?"AVAILABLE":t.status,type_id:((n=t.type)==null?void 0:n.id)||null}})}),H=()=>_(!1),q=V(),F=ot(P,{onSuccess:()=>Y()}),G=async t=>{await M(t),F.mutate()},K=(t,n)=>{_(!0);const[e]=s.seats.filter(T=>T.height_location===n+1&&T.width_location===t+1);O({width_location:t,height_location:n,type:(e==null?void 0:e.type)||null,status:(e==null?void 0:e.status)||"EMPTY",number:(e==null?void 0:e.number)||null})},J=()=>{z().then(()=>{q(lt.apply.studyRoom.list)})},{obj:j,changeObjectValue:a}=dt({floor:"",name:"",eastDescription:"",westDescription:"",southDescription:"",northDescription:""}),R=()=>((!i||i===0)&&a("floor","1 이상이어야 합니다."),u||a("name","공백일 수 없습니다."),r||a("eastDescription","공백일 수 없습니다."),c||a("westDescription","공백일 수 없습니다."),l||a("northDescription","공백일 수 없습니다."),m||a("southDescription","공백일 수 없습니다."),!!(i&&i!==0&&u&&r&&c&&l&&m));return o.jsxs(rt,{children:[f.selectedModal==="ADD_SEAT_TYPE"&&o.jsx(st,{}),o.jsx(at,{seatSetting:I,selectModal:L,seatTypeList:(d==null?void 0:d.types)||[],deleteSeatType:G,closeSeatSetting:H,addSeat:f.selectedModal==="ADD_SEAT_TYPE"}),o.jsxs(ht,{children:[o.jsx(Q,{left:351,pathToKorean:mt}),o.jsx(it,{onChange:g,floor:i,name:u,total_width_size:x,total_height_size:y,errorMessages:j,errorChange:R}),o.jsxs(St,{children:[o.jsx(X,{east_description:r,west_description:c,north_description:l,south_description:m,...C,seats:s.seats.map(t=>({...t,student:null})),isEdit:!0,selectedPosition:{x:s.seat.width_location,y:s.seat.height_location},onClickSeat:K,total_width_size:x,total_height_size:y}),o.jsx(nt,{setTimeSlotId:t=>{b(t)},onChangeSegmented:B,onChangeInput:g,onChangeGrade:v,createStudyRoom:J,onChangeStudyTime:k,default_time_slots_id:W(),isCreateRoom:!1,errorMessages:j,errorChange:R,east_description:r,west_description:c,north_description:l,south_description:m,patch:!0,...C})]})]})]})},ht=E.section`
  width: 1040px;
  margin: 0 auto;
  margin-top: 140px;
  margin-bottom: 50px;
`,St=E.div`
  display: flex;
  margin-top: 78px;
`;export{Ot as PatchRoom};
