import{j as a,k as f,I as r,B as g}from"./design-system-R5PU-KJ5.js";import{H as n}from"./style-vendor-CCa_bSPe.js";import{W as x}from"./WithNavigatorBar-BaUD9vuh.js";import{u as P}from"./useForm-DVm8TY_W.js";import{T as y}from"./TitleBox-CK0hfhyi.js";import{i as c,u as p}from"./queryKeys-B7CxYHCA.js";import{p as C,b as T}from"./index-BhlJXPXA.js";import{c as j,u as _}from"./query-vendor-CBGQWAC0.js";import{d as k}from"./react-vendor-DvN4Y5o0.js";import"./useSchoolsApi-kltzsy-n.js";import"./utils-vendor-Bc17E_qf.js";const i="/users",v=async e=>{await c.patch(`${i}/password`,e)},b=async e=>{await c.get(`${i}/password?password=${e}`)},S=e=>j(["checkPwd",e],()=>b(e),{refetchOnWindowFocus:!1,enabled:!1,retry:!1}),B=e=>{const{toastDispatch:s}=p(),o=k();return _(()=>v(e),{onSuccess:()=>{o(C.myPage.main),s({actionType:"APPEND_TOAST",toastType:"SUCCESS",message:"비밀번호가 변경되었습니다."})}})};function Q(){const{onHandleChange:e,state:{current_password:s,new_password:o,reCheckPassword:t}}=P({current_password:"",new_password:"",reCheckPassword:""}),{toastDispatch:d}=p(),{refetch:m}=S(s),{mutate:l}=B({current_password:s,new_password:o}),u=()=>{o!==t?d({toastType:"ERROR",actionType:"APPEND_TOAST",message:"확인 비밀번호가 일치하지 않습니다."}):m().then(()=>l())},h=w=>{w.preventDefault()};return a.jsx(x,{children:a.jsxs(D,{children:[a.jsx(f,{pathToKorean:T}),a.jsxs(E,{onSubmit:h,children:[a.jsx(y,{moreInfo:"비밀번호는 영문, 숫자, 기호를 포함한 8~20자이어야 합니다.",children:"비밀번호 변경"}),a.jsx(r,{margin:["top",40],value:s,onChange:e,name:"current_password",placeholder:"기존 비밀번호를 입력해주세요.",label:"기존 비밀번호 입력",type:"password"}),a.jsx(r,{margin:["top",40],value:o,onChange:e,name:"new_password",placeholder:"새로운 비밀번호를 입력해주세요.",label:"새 비밀번호 입력",type:"password"}),a.jsx(r,{margin:["top",40],value:t,onChange:e,name:"reCheckPassword",placeholder:"새로운 비밀번호를 다시 입력해주세요.",label:"새 비밀번호 확인",type:"password"}),a.jsx(g,{margin:[["top",40],["left","auto"]],kind:"contained",color:"primary",onClick:u,disabled:!(s&&o&&t),children:"완료"})]})]})})}const D=n.div`
  display: flex;
  flex-direction: column;
  width: calc(100vw - 250px);
`,E=n.form`
  margin: 170px auto 0 auto;
`;export{Q as ChangePwd};
