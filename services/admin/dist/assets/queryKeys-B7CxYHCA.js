import{C as T,b as d,A as l}from"./utils-vendor-Bc17E_qf.js";import{e as A}from"./index-BhlJXPXA.js";import{r as h}from"./react-vendor-DvN4Y5o0.js";import{s as E,u as _}from"./design-system-R5PU-KJ5.js";const D=new T,p=e=>D.get(e),u=(e,s,t)=>{D.set(e,s,{...t,path:"/"})},v=e=>new Date(e).toLocaleDateString().slice(0,-1).replace(/.\s/g,"/"),y=e=>{switch(e){case"ALL":return"남여 모두";case"MALE":return"남";case"FEMALE":return"여"}},Y=e=>{switch(e){case"남여 모두":return"ALL";case"남":return"MALE";case"여":return"FEMALE"}};function $(e){switch(e){case"FIRST":return"1학년";case"FIRST_AND_SECOND":return"1, 2학년";case"FIRST_AND_THIRD":return"1, 3학년";case"SECOND":return"2학년";case"SECOND_AND_THIRD":return"2, 3학년";case"THIRD":return"3학년";case"ALL":return"모든 학년";default:return e}}function F(e){switch(e){case"1학년":return"FRIST";case"1학년, 2학년":return"FIRST_AND_SECOND";case"2학년, 1학년":return"FIRST_AND_SECOND";case"1학년, 3학년":return"FIRST_AND_THIRD";case"3학년, 1학년":return"FIRST_AND_THIRD";case"2학년":return"SECOND";case"2학년, 3학년":return"SECOND_AND_THIRD";case"3학년, 2학년":return"SECOND_AND_THIRD";case"3학년":return"THIRD";case"모든 학년":return"ALL";default:return e}}const b=e=>{switch(e){case 0:return"모든 학년";case 1:return"1학년";case 2:return"2학년";case 3:return"3학년"}},O=e=>{switch(e){case"모든 학년":return 0;case"1학년":return 1;case"2학년":return 2;case"3학년":return 3}},U=e=>{switch(e){case"AVAILABLE":return"사용 가능";case"UNAVAILABLE":return"사용 불가";case"EMPTY":return"빈 공간"}},H=e=>{switch(e){case"사용 가능":return"AVAILABLE";case"사용 불가":return"UNAVAILABLE";case"빈 공간":return"EMPTY"}},f=e=>{switch(e){case"study_room_service":return{service:"신청",index:1};case"point_service":return{service:"홈",index:0};case"notice_service":return{service:"공지",index:2};case"meal_service":default:return{service:"",index:-99}}},K=e=>{switch(e){case"월":return"MONDAY";case"화":return"TUESDAY";case"수":return"WEDNESDAY";case"목":return"THURSDAY";case"금":return"FRIDAY";case"토":return"SATURDAY";case"일":return"SUNDAY"}},j=e=>{switch(e){case"MONDAY":return"월";case"TUESDAY":return"화";case"WEDNESDAY":return"수";case"THURSDAY":return"목";case"FRIDAY":return"금";case"SATURDAY":return"토";case"SUNDAY":return"일"}},m=e=>Object.entries(e).map(s=>f(s[0])).concat({service:"설문",index:3}).concat({service:"마이페이지",index:4}).sort((s,t)=>s.index-t.index).map(s=>s.service),S=e=>{const s=m(e),t=new Date;t.setFullYear(t.getFullYear()+10),u("service",s.toString(),{expires:t})},c="/auth",M=async e=>{const{data:s}=await a.post(`${c}/tokens`,e);return s},g=async e=>(await a.put(`${c}/reissue`,null,{headers:{"refresh-token":`${e}`}}).then(t=>(S(t.data.features),t))).data,P=async e=>{await a.post(`${c}/code`,e)},B=async(e,s,t)=>{await a.get(`${c}/code?email=${e}&auth_code=${s}&type=${t}`)},q=async e=>{const{data:s}=await a.get(`${c}/account-id?account_id=${e}`);return s};let o=!1,i=[];const k=e=>{i.forEach(s=>s(e)),i=[]},w=()=>{const e=p("refresh_token");return e?o?new Promise(s=>{i.push(t=>s(t))}):(o=!0,new Promise((s,t)=>{g(e).then(r=>{const n=r.access_token;u("access_token",n,{expires:new Date(r.access_token_expired_at)}),u("refresh_token",r.refresh_token,{expires:new Date(r.refresh_token_expired_at)}),o=!1,k(n),s(n)}).catch(r=>{o=!1,i=[],A.emit("sessionExpired"),t(r)})})):(A.emit("sessionExpired"),Promise.reject(new Error("No refresh token available")))},x=e=>typeof e=="object"&&e!==null&&"message"in e,N=e=>{if(e.response){const{status:s,data:t}=e.response,r=x(t)?t.message:"알 수 없는 오류가 발생했습니다.";switch(s){case 400:console.log(`[${s}] 잘못된 요청입니다.
${r}`);break;case 404:console.log("요청하신 자원을 찾을 수 없습니다.");break;case 500:console.log("서버에 문제가 발생했습니다. 잠시 후 다시 시도해주세요.");break;default:console.log(`[${s}] 오류가 발생했습니다.
${r}`);break}}else console.log("네트워크 오류가 발생했습니다. 인터넷 연결을 확인해주세요.");return Promise.reject(e)},a=d.create({baseURL:"https://dev-api.dms-dsm.com",timeout:1e4});a.interceptors.request.use(e=>{const s=p("access_token");return s&&(e.headers=new l({...e.headers,Authorization:`Bearer ${s}`})),e},e=>Promise.reject(e));a.interceptors.response.use(e=>e,async e=>{var t,r;const s=e.config;if(((t=e.response)==null?void 0:t.status)===401||((r=e.response)==null?void 0:r.status)===403){if(s._retry)return Promise.reject(e);s._retry=!0;try{const n=await w();return s.headers=new l({...s.headers,Authorization:`Bearer ${n}`}),a(s)}catch(n){return Promise.reject(n)}}return N(e)});const V=()=>{const e=h.useContext(E),s=h.useContext(_);return{toastState:e,toastDispatch:s}},W={학교리스트조회:"getSchoolList",학교확인질문확인:"getSchoolQuestion",아이디존재여부확인:"checkEmailDuplicate",이메일인증코드확인:"checkEmailAuthCode",사용가능기능조회:"availAbleFeatures",외출신청내역상세보기:"fetchOutingApplicationDetail",외출신청내역조회:"fetchOutingApplications"};export{u as a,B as b,q as c,v as d,y as e,U as f,b as g,H as h,a as i,Y as j,O as k,M as l,j as m,K as n,$ as o,P as p,W as q,F as r,S as s,p as t,V as u};
